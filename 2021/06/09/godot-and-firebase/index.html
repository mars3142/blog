<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="mars3142 Blog"><meta property="og:type" content="article"><meta property="og:image" content="/img/2021/06/09/godot-and-firebase/godot_source_code.webp"><meta property="twitter:image" content="/img/2021/06/09/godot-and-firebase/godot_source_code.webp"><meta name=title content="Godot and Firebase"><meta property="og:title" content="Godot and Firebase"><meta property="twitter:title" content="Godot and Firebase"><meta name=description content><meta property="og:description" content><meta property="twitter:description" content><meta property="twitter:card" content="summary"><meta name=keyword content="ESP32, STM32, 3D Printing, Godot"><link rel="shortcut icon" href=/img/favicon.ico><title>Godot and Firebase | mars3142 Blog</title><link rel=canonical href=/2021/06/09/godot-and-firebase/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link rel=stylesheet href=/css/font-awesome.all.min.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/hux-blog.min.js></script><script src=/js/lazysizes.min.js></script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-RLV3MZ3T8N"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-RLV3MZ3T8N")}</script><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/>mars3142 Blog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/categories/godot/>godot</a></li><li><a href=/archive//>ARCHIVE</a></li><li><a href=/about//>ABOUT</a></li><li><a href=/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><header class=intro-header style=background-image:url(/img/home-bg-flutter.jpg)><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=site-heading><h1>mars3142 Blog</h1><span class=subheading></span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-1
col-md-8 col-md-offset-1
col-sm-12
col-xs-12
post-container"><p><img src=/img/2021/06/09/godot-and-firebase/godot_source_code.webp alt="Godot source code"></p><p>Multiplayer games need some form of user authentication. To build a custom backend is a hard part, but to create secure user authentication is another story. For saving the user/game state you can use different approaches. In my case I wanted to use Firebase, but the primary authentication for Firebase is via email and password. This will be a two part tutorial for using Godot with Firebase with username and password.</p><p>I found many bad solutions for that, which I would never recommend for that purpose. Most of time I read &ldquo;add a fake domain, so you create an email address&rdquo;. But the worst advice was, read credentials from Realtime Database with the json options within the game client. This is only possible, if you allow everybody to read the complete user collection. <strong>DON&rsquo;T ALLOW THAT.</strong></p><p>For the communication between Godot and Firebase I found a useful module: <a href=https://github.com/GodotNuts/GodotFirebase>https://github.com/GodotNuts/GodotFirebase</a>. This module is able to login into Firebase and use Cloud Firestore as a persistence layer. But also this module used email and password for authentication. So I created a discussion to use an official feature of Firebase: Login with custom token.</p><p>The module can&rsquo;t create a custom token, because don&rsquo;t trust the client. So you need to generate in a trusted environment: your server. Because we want to use Firebase, I go the full route and created an API with Firebase Functions, which my backend game server can connect. So my API will never be exposed to the client and because I use also a custom header within my request, no one with knowledge of my server URI can use the API.</p><p>Because the code is large and I just want to give an overview how to do it, I will just paste some snippets so you understand the process. If needed, I could create a sample project.</p><p>To start with the authentication, we need to store our users with username and password. I used the idea from above with the Realtime Database, but my database is unreadable for everybody (only admin accounts like Firebase Functions can access the data). To ensure that the user credentials are save (not recoverable or visible), I use the node package firebase-scrypt. This will use some parameters, which can be found within the auth section of Firebase behind the three dots (or you use your own).</p><script src=https://gist.github.com/mars3142/53dac924f07bddf45e565fd8fa993a72.js></script><p>The important part starts at line 25 and following. Every user get&rsquo;s a random salt and the password is created from the data given by the user (which also can be hashed once on the client as well). In line 32 we store everything in our user node within the Realtime Database.</p><p><img src=/img/2021/06/09/godot-and-firebase/firebase_user.webp alt="Firebase Realtime Database"></p><script src=https://gist.github.com/mars3142/d77df1db6cbbbb9ef2107f4041b90f65.js></script><p>The signin part is not that difficult. It’s the line 27. You need the password, the stored salt and hash to verify if everything is correct. That’s why we stored everything in our database.</p><script src=https://gist.github.com/mars3142/baf148df2ee0ed3d3146341deb84660f.js></script><p>This is the most important code, because in line 2 we create the custom token for logging into Firebase. This token is a normal JWT and can be used to login into Firebase.</p><p><img src=/img/2021/06/09/godot-and-firebase/firebase_auth.webp alt="Firebase Auth"></p><p>In the next part I’ll show you how to connect the API and Firebase with that custom token.</p><div id=disqus-comment></div><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//mars3142.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div class="col-lg-3 col-lg-offset-0
col-md-3 col-md-offset-0
col-sm-12
col-xs-12
sidebar-container"><section class="visible-md visible-lg"><div class=short-about><a href=/about><img src=/img/avatar.jpg alt=avatar style=cursor:pointer></a><p>Software Developer, Open Source Enthusiast and Maker</p><ul class=list-inline><li><a href=mailto:developer@mars3142.org><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/mars3142><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/petersiegmund><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://medium.com/@mars3142><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-medium fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://stackoverflow.com/users/708157><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.reddit.com/user/mars3142/><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-reddit fa-stack-1x fa-inverse"></i></span></a></li></ul></div></section><section><hr class="hidden-sm hidden-xs"><h5>FEATURED TAGS</h5><div class=tags><a href=/tags/firebase title=firebase>firebase
</a><a href=/tags/tutorial title=tutorial>tutorial</a></div></section><section><hr class="hidden-sm hidden-xs"><h5>FRIENDS</h5><ul class=list-inline><li><a target=_blank href=https://blog.mbirth.uk/>Markus Birth</a></li></ul></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:developer@mars3142.org><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/mars3142><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/petersiegmund><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://medium.com/@mars3142><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-medium fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://stackoverflow.com/users/708157><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.reddit.com/user/mars3142/><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-reddit fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title="mars3142 Blog"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; mars3142 Blog 2025<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){n=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),t=$(this).text(),i=$('<a href="'+o+'" rel="nofollow" title="'+t+'">'+t+"</a>"),s=$('<li class="'+n+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>